{"ast":null,"code":"import _slicedToArray from\"D:/rentup/rentup_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Page from\"../common/Page\";import classes from\"./RentRegisterPage.module.css\";import RecentCard from\"../HomePage/Recent/RecentCard\";import LandlordCard from\"../HomePage/landlord/LandlordCard\";import Back from\"../common/Back/Back\";import{getRoomByRoomId}from\"../../../api/RoomApi\";import{createRentRequest}from\"../../../api/RentRequestApi\";import{useState,useEffect,useContext,useRef}from\"react\";import AuthContext from'../../../store/auth-context';import{useParams}from'react-router-dom';import img from\"../../../assets/img/backgroundPost.jpg\";import{useHistory}from\"react-router-dom\";import Popup from\"../common/Popup/Popup\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RentRegisterPage=function RentRegisterPage(){var history=useHistory();var params=useParams();var id=params.id;var authCtx=useContext(AuthContext);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),landlord=_useState4[0],setLandlord=_useState4[1];var messageInputRef=useRef();var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),popup=_useState6[0],setPopup=_useState6[1];var _useState7=useState('Create request successfully'),_useState8=_slicedToArray(_useState7,2),popupTitle=_useState8[0],setPopupTitle=_useState8[1];var _useState9=useState('Your request has been created!'),_useState10=_slicedToArray(_useState9,2),popupDetail=_useState10[0],setPopupDetail=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),popupRedirect=_useState12[0],setPopupRedirect=_useState12[1];useEffect(function(){getRoomByRoomId(id).then(function(data){setPost({room_id:data.id,room_name:data.name,cover:data.image,category:data.category.name,city:data.house.city,district:data.house.district,ward:data.house.ward,totalPrice:data.totalPrice});setLandlord({cover:data.house.landlord.image,name:data.house.landlord.username,address:data.house.landlord.city+' - '+data.house.landlord.district+' - '+data.house.landlord.ward,phone:data.house.landlord.phone,linkfb:data.house.landlord.linkfb,linkin:data.house.landlord.linkin,linktw:data.house.landlord.linktw,linkli:data.house.landlord.linkli});}).catch(function(err){alert(err.message);});},[]);var sendRequest=function sendRequest(){var data={room:id,message:messageInputRef.current.value};createRentRequest(data,authCtx.token).then(function(response){if(response.status===400){setPopupTitle(response.statusText);setPopupDetail(response.data);setPopupRedirect(false);}if(response.status===200){setPopupTitle('Create request successfully');setPopupDetail('Your request has been created!');setPopupRedirect(true);}setPopup(true);}).catch(function(err){alert(err.message);});};var redirectPage=function redirectPage(){if(popupRedirect){history.replace('/manage/your_request');}else{setPopup(false);}};return/*#__PURE__*/_jsxs(Page,{children:[/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(Back,{name:\"Rent Register\",title:\"Your Rent Register\",cover:img}),/*#__PURE__*/_jsx(\"section\",{className:\"\".concat(classes.recent,\" \").concat(classes.padding),children:/*#__PURE__*/_jsx(\"div\",{className:classes.container,children:/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(classes.grid1,\" \").concat(classes.mtop),children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(classes.shadow,\" \").concat(classes.rentRequestCard),children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.rentRequestCard_info,children:[/*#__PURE__*/_jsx(RecentCard,{item:post}),/*#__PURE__*/_jsx(LandlordCard,{item:landlord})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.rentRequestCard_message,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Message:\"}),/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",ref:messageInputRef})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(classes.rentRequestCard_action),children:/*#__PURE__*/_jsx(\"button\",{onClick:sendRequest,children:\"Send\"})})]},id)})})})]}),/*#__PURE__*/_jsxs(Popup,{trigger:popup,children:[/*#__PURE__*/_jsx(\"h3\",{children:popupTitle}),/*#__PURE__*/_jsx(\"p\",{children:popupDetail}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:redirectPage,children:\"Ok\"})]})]});};export default RentRegisterPage;","map":{"version":3,"names":["Page","classes","RecentCard","LandlordCard","Back","getRoomByRoomId","createRentRequest","useState","useEffect","useContext","useRef","AuthContext","useParams","img","useHistory","Popup","RentRegisterPage","history","params","id","authCtx","post","setPost","landlord","setLandlord","messageInputRef","popup","setPopup","popupTitle","setPopupTitle","popupDetail","setPopupDetail","popupRedirect","setPopupRedirect","then","data","room_id","room_name","name","cover","image","category","city","house","district","ward","totalPrice","username","address","phone","linkfb","linkin","linktw","linkli","catch","err","alert","message","sendRequest","room","current","value","token","response","status","statusText","redirectPage","replace","recent","padding","container","grid1","mtop","shadow","rentRequestCard","rentRequestCard_info","rentRequestCard_message","rentRequestCard_action"],"sources":["D:/rentup/rentup_frontend/src/core/components/RentRegisterPage/RentRegisterPage.js"],"sourcesContent":["import Page from \"../common/Page\"\r\nimport classes from \"./RentRegisterPage.module.css\"\r\nimport RecentCard from \"../HomePage/Recent/RecentCard\";\r\nimport LandlordCard from \"../HomePage/landlord/LandlordCard\"\r\nimport Back from \"../common/Back/Back\"\r\nimport {getRoomByRoomId} from \"../../../api/RoomApi\"\r\nimport {createRentRequest} from \"../../../api/RentRequestApi\"\r\nimport { useState, useEffect, useContext, useRef } from \"react\"\r\nimport AuthContext from '../../../store/auth-context';\r\nimport { useParams } from 'react-router-dom';\r\nimport img from \"../../../assets/img/backgroundPost.jpg\"\r\nimport { useHistory } from \"react-router-dom\";\r\nimport Popup from \"../common/Popup/Popup\"\r\n\r\n\r\n\r\nconst RentRegisterPage = () => {\r\n    const history = useHistory()\r\n    \r\n    const params = useParams()\r\n\r\n    const id = params.id\r\n    \r\n    const authCtx = useContext(AuthContext)\r\n    \r\n    const [post, setPost] = useState({})\r\n    const [landlord, setLandlord] = useState({})\r\n    const messageInputRef = useRef()\r\n    \r\n    const [popup, setPopup] = useState(false)\r\n    const [popupTitle, setPopupTitle] = useState('Create request successfully')\r\n    const [popupDetail, setPopupDetail] = useState('Your request has been created!')\r\n    const [popupRedirect, setPopupRedirect] = useState(false)\r\n    \r\n    useEffect(() => {\r\n        getRoomByRoomId(id)\r\n        .then((data) => {\r\n            setPost({\r\n                room_id: data.id,\r\n                room_name: data.name,\r\n                cover: data.image,\r\n                category: data.category.name,\r\n                city: data.house.city,\r\n                district: data.house.district,\r\n                ward: data.house.ward,\r\n                totalPrice: data.totalPrice\r\n            })\r\n            setLandlord({\r\n                cover: data.house.landlord.image,\r\n                name: data.house.landlord.username,\r\n                address: data.house.landlord.city + ' - ' + data.house.landlord.district + ' - ' + data.house.landlord.ward,\r\n                phone: data.house.landlord.phone,\r\n                linkfb: data.house.landlord.linkfb,\r\n                linkin: data.house.landlord.linkin,\r\n                linktw: data.house.landlord.linktw,\r\n                linkli: data.house.landlord.linkli,\r\n            })\r\n        })\r\n        .catch((err) => {\r\n                alert(err.message);\r\n        });\r\n    }, [])\r\n    \r\n    const sendRequest = () => {\r\n        const data = {\r\n            room: id,\r\n            message: messageInputRef.current.value,\r\n        }\r\n        \r\n        createRentRequest(data, authCtx.token)\r\n        .then(response => {\r\n            if(response.status === 400){\r\n                setPopupTitle(response.statusText)\r\n                setPopupDetail(response.data)\r\n                setPopupRedirect(false)\r\n            }\r\n            if(response.status === 200){\r\n                setPopupTitle('Create request successfully')\r\n                setPopupDetail('Your request has been created!')\r\n                setPopupRedirect(true)\r\n            }\r\n            setPopup(true)\r\n        })\r\n        .catch((err) => {\r\n            alert(err.message);\r\n        });\r\n    }\r\n    \r\n    const redirectPage = () => {\r\n        if(popupRedirect){\r\n            history.replace('/manage/your_request')\r\n        }else{\r\n            setPopup(false)\r\n        }\r\n    }\r\n    \r\n    return (\r\n        <Page>\r\n            <section>\r\n                <Back name='Rent Register' title='Your Rent Register' cover={img}/>\r\n                <section className={`${classes.recent} ${classes.padding}`}>\r\n                    <div className={classes.container}>\r\n                        <div className={`${classes.grid1} ${classes.mtop}`}>\r\n                            <div className={`${classes.shadow} ${classes.rentRequestCard}`} key={id}>\r\n                                <div className={classes.rentRequestCard_info}>\r\n                                    <RecentCard item={post}/>\r\n                                    <LandlordCard item={landlord}/>\r\n                                </div>\r\n                                <div className={classes.rentRequestCard_message}>\r\n                                    <h2>Message:</h2>\r\n                                    <textarea type=\"text\" ref={messageInputRef}/>\r\n                                </div>\r\n                                <div className={`${classes.rentRequestCard_action}`}>\r\n                                    <button onClick={sendRequest}>Send</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n            </section>\r\n            <Popup trigger={popup}>\r\n                <h3>{popupTitle}</h3>\r\n                <p>{popupDetail}</p>\r\n                <button type=\"button\" onClick={redirectPage}>Ok</button>\r\n            </Popup>\r\n        </Page>\r\n    )\r\n}\r\n\r\nexport default RentRegisterPage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}