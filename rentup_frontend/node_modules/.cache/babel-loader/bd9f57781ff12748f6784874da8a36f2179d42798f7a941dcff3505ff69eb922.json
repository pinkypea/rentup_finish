{"ast":null,"code":"import _slicedToArray from\"D:/rentup/rentup_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classes from\"./SigninPage.module.css\";import img from\"../../../assets/img/backgroundSignin.jpg\";import{useRef,useContext,useEffect,useState}from\"react\";import AuthContext from'../../../store/auth-context';import{Link,useHistory}from\"react-router-dom\";import{signinApi,getOauth2Info}from\"../../../api/AuthApi\";import Popup from\"../common/Popup/Popup\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SigninPage=function SigninPage(){var history=useHistory();var authCtx=useContext(AuthContext);var usernameInputRef=useRef(\"\");var passwordInputRef=useRef(\"\");var _useState=useState(''),_useState2=_slicedToArray(_useState,2),client_id=_useState2[0],setClient_id=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),client_serect=_useState4[0],setClient_serect=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),popup=_useState6[0],setPopup=_useState6[1];useEffect(function(){getOauth2Info().then(function(data){setClient_id(data.client_id);setClient_serect(data.client_serect);}).catch(function(err){alert(err.message);});});var reloadPage=function reloadPage(){setPopup(false);};var submitHandler=function submitHandler(event){event.preventDefault();var enteredUsername=usernameInputRef.current.value;var enteredPassword=passwordInputRef.current.value;// optional: Add validation\nsigninApi(enteredUsername,enteredPassword,client_id,client_serect).then(function(data){console.log(data);if(data.error){setPopup(true);}else{var expirationTime=new Date(new Date().getTime()+ +data.expires_in*1000);authCtx.login(data.access_token,expirationTime.toISOString());history.replace(\"/\");}}).catch(function(err){console.log(err);});};return/*#__PURE__*/_jsxs(\"section\",{className:classes.back,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.center,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Sign In\"}),/*#__PURE__*/_jsxs(\"form\",{method:\"POST\",onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.txt_field,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,ref:usernameInputRef}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Username\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.txt_field,children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",required:true,ref:passwordInputRef}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Password\"})]}),/*#__PURE__*/_jsx(Link,{className:classes.pass,to:\"/forget_password\",children:\"Forgot Password?\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:classes.signup_link,children:[\"Not a member? \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"Signup\"})]})]})]}),/*#__PURE__*/_jsx(\"img\",{src:img,alt:\"\"}),/*#__PURE__*/_jsxs(Popup,{trigger:popup,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Failed\"}),/*#__PURE__*/_jsx(\"p\",{children:\"wrong username or password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:reloadPage,children:\"Ok\"})]})]});};export default SigninPage;","map":{"version":3,"names":["classes","img","useRef","useContext","useEffect","useState","AuthContext","Link","useHistory","signinApi","getOauth2Info","Popup","SigninPage","history","authCtx","usernameInputRef","passwordInputRef","client_id","setClient_id","client_serect","setClient_serect","popup","setPopup","then","data","catch","err","alert","message","reloadPage","submitHandler","event","preventDefault","enteredUsername","current","value","enteredPassword","console","log","error","expirationTime","Date","getTime","expires_in","login","access_token","toISOString","replace","back","center","txt_field","pass","signup_link"],"sources":["D:/rentup/rentup_frontend/src/core/components/SigninPage/SigninPage.js"],"sourcesContent":["import classes from \"./SigninPage.module.css\"\r\nimport img from \"../../../assets/img/backgroundSignin.jpg\"\r\nimport { useRef, useContext, useEffect, useState } from \"react\"\r\nimport AuthContext from '../../../store/auth-context';\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { signinApi, getOauth2Info } from \"../../../api/AuthApi\";\r\nimport Popup from \"../common/Popup/Popup\"\r\n\r\n\r\nconst SigninPage = () => {\r\n    const history = useHistory()\r\n    \r\n    const authCtx = useContext(AuthContext)\r\n    \r\n    const usernameInputRef = useRef(\"\")\r\n    const passwordInputRef = useRef(\"\")\r\n    \r\n    const [client_id, setClient_id] = useState('')\r\n    const [client_serect, setClient_serect] = useState('')\r\n    \r\n    const [popup, setPopup] = useState(false)\r\n    \r\n    useEffect(() => {\r\n        getOauth2Info()\r\n        .then((data) => {\r\n            setClient_id(data.client_id)\r\n            setClient_serect(data.client_serect)\r\n        })\r\n        .catch((err) => {\r\n            alert(err.message);\r\n        });\r\n    })\r\n    \r\n    const reloadPage = () => {\r\n        setPopup(false)  \r\n    }\r\n    \r\n    const submitHandler = (event) => {\r\n        event.preventDefault();\r\n        \r\n        const enteredUsername = usernameInputRef.current.value;\r\n        const enteredPassword = passwordInputRef.current.value;\r\n        \r\n        // optional: Add validation\r\n        \r\n        signinApi(enteredUsername, enteredPassword, client_id, client_serect)\r\n        .then((data) => {\r\n            console.log(data)\r\n            if(data.error) {\r\n                setPopup(true)\r\n            }else {\r\n                const expirationTime = new Date(\r\n                    new Date().getTime() + +data.expires_in * 1000\r\n                );\r\n                authCtx.login(data.access_token, expirationTime.toISOString());\r\n                history.replace(\"/\")\r\n            }\r\n        })\r\n        .catch((err) => {\r\n            console.log(err)\r\n        });\r\n    }\r\n    \r\n    return (\r\n        <section className={classes.back}>\r\n            <div className={classes.center}>\r\n                <h1>Sign In</h1>\r\n                <form method=\"POST\" onSubmit={submitHandler}>\r\n                    <div className={classes.txt_field}>\r\n                        <input type=\"text\" required ref={usernameInputRef}/>\r\n                        <span></span>\r\n                        <label>Username</label>\r\n                    </div>\r\n                    <div className={classes.txt_field}>\r\n                        <input type=\"password\" required ref={passwordInputRef}/>\r\n                        <span></span>\r\n                        <label>Password</label>\r\n                    </div>\r\n                    <Link className={classes.pass} to=\"/forget_password\">Forgot Password?</Link>\r\n                    <button type=\"submit\">Login</button>\r\n                    <div className={classes.signup_link}>\r\n                        Not a member? <Link to=\"/signup\">Signup</Link>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            <img src={img} alt='' />\r\n            <Popup trigger={popup}>\r\n                <h3>Failed</h3>\r\n                <p>wrong username or password</p>\r\n                <button type=\"button\" onClick={reloadPage}>Ok</button>\r\n            </Popup>\r\n        </section>\r\n    )\r\n}\r\n\r\nexport default SigninPage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}