{"ast":null,"code":"import _slicedToArray from\"D:/rentup/rentup_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState,useContext}from\"react\";import{Link,useHistory}from\"react-router-dom\";import{changePassword}from\"../../../api/UserApi\";import img from\"../../../assets/img/backgroundSignin.jpg\";import Popup from\"../common/Popup/Popup\";import classes from\"./ChangePasswordPage.module.css\";import AuthContext from'../../../store/auth-context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChangePasswordPage=function ChangePasswordPage(){var oldPasswordInputRef=useRef(\"\");var newPasswordInputRef=useRef(\"\");var passwordRepeatInputRef=useRef(\"\");var _useState=useState('Change password successfully'),_useState2=_slicedToArray(_useState,2),popupTitle=_useState2[0],setPopupTitle=_useState2[1];var _useState3=useState('Your password has been updated'),_useState4=_slicedToArray(_useState3,2),popupDetail=_useState4[0],setPopupDetail=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),popupRedirect=_useState6[0],setPopupRedirect=_useState6[1];var authCtx=useContext(AuthContext);var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),popup=_useState8[0],setPopup=_useState8[1];var history=useHistory();var submitHandler=function submitHandler(event){event.preventDefault();var enteredOldPassword=oldPasswordInputRef.current.value;var enteredNewPassword=newPasswordInputRef.current.value;var enteredPasswordRepeat=passwordRepeatInputRef.current.value;if(enteredNewPassword!==enteredPasswordRepeat){setPopupTitle('Failed');setPopupDetail('Repeated password is not the same');setPopupRedirect(false);setPopup(true);return;}var data={old_password:enteredOldPassword,new_password:enteredNewPassword};changePassword(authCtx.token,data).then(function(response){// console.log(response)\nif(response.status===400){setPopupTitle(response.statusText);setPopupDetail(response.data);setPopupRedirect(false);setPopup(true);}if(response.status===200){setPopupTitle('Change password successfully');setPopupDetail('Your password has been updated');setPopupRedirect(true);authCtx.logout();history.replace(\"/signin\");setPopup(true);}}).catch(function(error){return console.error(error);});};var redirectSigninPage=function redirectSigninPage(){if(popupRedirect){history.replace(\"/signin\");}else{setPopup(false);}};return/*#__PURE__*/_jsxs(\"section\",{className:classes.back,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.center,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Change Password\"}),/*#__PURE__*/_jsxs(\"form\",{method:\"POST\",onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.txt_field,children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",required:true,ref:oldPasswordInputRef}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Old Password\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.txt_field,children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",required:true,ref:newPasswordInputRef}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"New Password\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.txt_field,children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",required:true,ref:passwordRepeatInputRef}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Password Repeat\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.signup_link,children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"home\"})})]}),/*#__PURE__*/_jsxs(Popup,{trigger:popup,children:[/*#__PURE__*/_jsx(\"h3\",{children:popupTitle}),/*#__PURE__*/_jsx(\"p\",{children:popupDetail}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:redirectSigninPage,children:\"Ok\"})]})]}),/*#__PURE__*/_jsx(\"img\",{src:img,alt:\"\"})]});};export default ChangePasswordPage;","map":{"version":3,"names":["useRef","useState","useContext","Link","useHistory","changePassword","img","Popup","classes","AuthContext","ChangePasswordPage","oldPasswordInputRef","newPasswordInputRef","passwordRepeatInputRef","popupTitle","setPopupTitle","popupDetail","setPopupDetail","popupRedirect","setPopupRedirect","authCtx","popup","setPopup","history","submitHandler","event","preventDefault","enteredOldPassword","current","value","enteredNewPassword","enteredPasswordRepeat","data","old_password","new_password","token","then","response","status","statusText","logout","replace","catch","error","console","redirectSigninPage","back","center","txt_field","signup_link"],"sources":["D:/rentup/rentup_frontend/src/core/components/ChangePasswordPage/ChangePasswordPage.js"],"sourcesContent":["import { useRef, useState, useContext } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { changePassword } from \"../../../api/UserApi\";\r\nimport img from \"../../../assets/img/backgroundSignin.jpg\";\r\nimport Popup from \"../common/Popup/Popup\";\r\nimport classes from \"./ChangePasswordPage.module.css\";\r\nimport AuthContext from '../../../store/auth-context';\r\n\r\n\r\nconst ChangePasswordPage = () => {\r\n    const oldPasswordInputRef = useRef(\"\")\r\n    const newPasswordInputRef = useRef(\"\")\r\n    const passwordRepeatInputRef = useRef(\"\")\r\n    \r\n    const [popupTitle, setPopupTitle] = useState('Change password successfully')\r\n    const [popupDetail, setPopupDetail] = useState('Your password has been updated')\r\n    const [popupRedirect, setPopupRedirect] = useState(false)\r\n    \r\n    const authCtx = useContext(AuthContext)\r\n    \r\n    const [popup, setPopup] = useState(false)\r\n    \r\n    const history = useHistory()\r\n    \r\n    const submitHandler = (event) => {\r\n        event.preventDefault();\r\n        \r\n        const enteredOldPassword = oldPasswordInputRef.current.value;\r\n        const enteredNewPassword = newPasswordInputRef.current.value;\r\n        const enteredPasswordRepeat = passwordRepeatInputRef.current.value;\r\n        \r\n        if(enteredNewPassword !== enteredPasswordRepeat){\r\n            setPopupTitle('Failed')\r\n            setPopupDetail('Repeated password is not the same')\r\n            setPopupRedirect(false)\r\n            setPopup(true)\r\n            return;\r\n        }\r\n        \r\n        const data = {\r\n            old_password: enteredOldPassword, \r\n            new_password: enteredNewPassword\r\n        }\r\n        \r\n        changePassword(authCtx.token, data)\r\n        .then((response) => {\r\n            // console.log(response)\r\n            if(response.status === 400) {\r\n                setPopupTitle(response.statusText)\r\n                setPopupDetail(response.data)\r\n                setPopupRedirect(false)\r\n                setPopup(true)\r\n            }\r\n            if(response.status === 200){\r\n                setPopupTitle('Change password successfully')\r\n                setPopupDetail('Your password has been updated')\r\n                setPopupRedirect(true)\r\n                authCtx.logout()\r\n                history.replace(\"/signin\")\r\n                setPopup(true)\r\n            }\r\n        })\r\n        .catch((error) => console.error(error))\r\n    }\r\n    \r\n    const redirectSigninPage = () => {\r\n        if(popupRedirect){\r\n            history.replace(\"/signin\")    \r\n        }else{\r\n            setPopup(false)\r\n        }    \r\n    }\r\n    \r\n    return (\r\n        <section className={classes.back}>\r\n            <div className={classes.center}>\r\n                <h1>Change Password</h1>\r\n                <form method=\"POST\" onSubmit={submitHandler}>\r\n                    <div className={classes.txt_field}>\r\n                        <input type=\"password\" required ref={oldPasswordInputRef}/>\r\n                        <span></span>\r\n                        <label>Old Password</label>\r\n                    </div>\r\n                    <div className={classes.txt_field}>\r\n                        <input type=\"password\" required ref={newPasswordInputRef}/>\r\n                        <span></span>\r\n                        <label>New Password</label>\r\n                    </div>\r\n                    <div className={classes.txt_field}>\r\n                        <input type=\"password\" required ref={passwordRepeatInputRef}/>\r\n                        <span></span>\r\n                        <label>Password Repeat</label>\r\n                    </div>\r\n                    <button type=\"submit\">Submit</button>\r\n                    <div className={classes.signup_link}>\r\n                        <Link to=\"/\">home</Link>\r\n                    </div>\r\n                </form>\r\n                <Popup trigger={popup}>\r\n                    <h3>{popupTitle}</h3>\r\n                    <p>{popupDetail}</p>\r\n                    <button type=\"button\" onClick={redirectSigninPage}>Ok</button>\r\n                </Popup>\r\n            </div>\r\n            <img src={img} alt='' />\r\n        </section>\r\n    )\r\n}\r\n\r\nexport default ChangePasswordPage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}